<!DOCTYPE html>
<html>
<head>
  <title>FIFA World Cup Pool First Stage</title>
  <link rel="stylesheet" href="css/bootstrap.css">
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <script type="text/x-handlebars" data-template-name="application">
    <div class="container-fluid">
      <div class="row">
        <div class="col-md-8">
          {{outlet}}
        </div>
      
        <div class="col-md-3">
          {{#if auth.authed }}
            {{ auth.currentUser.name }}
            <a {{ action logout }}>Logout</a>
          {{else}}
            <button class="btn btn-success" {{ action login }}>Sign in</button>
          {{/if}}
          {{outlet ranking}}
        </div>
      </div>
    </div>
  </script>

  <script type="text/x-handlebars" data-template-name="index">
    {{matches-table matches=matches}}
  </script>

  <script type="text/x-handlebars" id="components/matches-table"> 
    <table class="table matches">
      <thead>
        <tr>
          <th>Date</th>
          <th colspan="5">
            Score/Prediction
          </th>
          {{#if user}} 
            <th>Points</th>
          {{/if}}
        </tr>
      </thead>
      {{#each match in matches itemController="match"}}
        <tr>
          <td class="match-date">{{match.matchDate}} {{match.matchTime}}</td>
          <td class="home-team" {{bind-attr class=match.home.id}}>
            <span class="team">{{match.home.name}}</span>
            <img {{bind-attr src=match.home.flag alt=match.home.id}} class="flag"> 
          </td>
          <td class="home-score score">
            {{match.homeGoalsDisplay}}
            {{#if user}} 
              <div class="prediction">
                {{#if match.editable}}
                  {{input type="number" value=match.prediction.homePrediction insert-newline="updatePrediction" class="form-control"}}
                {{else}}
                  {{match.homePredictionDisplay}}
                {{/if}} 
              </div>
            {{/if}}
          </td> 
          <td class="vs">-</td> 
          <td class="visitor-score score">
            {{match.visitorGoalsDisplay}}
            {{#if user}} 
              <div class="prediction">
                {{#if match.editable}}
                  {{input type="number" value=match.prediction.visitorPrediction insert-newline="updatePrediction" class="form-control"}}
                {{else}}
                  {{match.visitorPredictionDisplay}}
                {{/if}} 
              </div>
            {{/if}}
          </td> 
          <td class="visitor-team" {{bind-attr class=match.visitor.id}}>
            <img {{bind-attr src=match.visitor.flag alt=match.visitor.id}} class="flag"> 
            <span class="team">{{match.visitor.name}}</span>
          </td>
          {{#if user}} 
            <td class="points">
              {{match.userPoints}}</div>
            </td>
          {{/if}}
        </tr>
      {{/each}}
    </table>
  </script>
  
  <script type="text/x-handlebars" data-template-name="teams">
    <h2>Teams</h2>
    <ul>
    {{#each team in model}}
      <li>
        <img {{bind-attr src=team.flag alt=team.code}} class="flag">
        {{team.name}}
      </li>
    {{/each}}
    </ul>
  </script>

  <script type="text/x-handlebars" data-template-name="matches">
    {{matches-table matches=model}}
  </script>

  <script type="text/x-handlebars" data-template-name="users">
    <div id="ranking">
      {{#each user in model}}
        <div class="ranking-user">
          {{#link-to 'user' user}}
            <img {{bind-attr src=user.avatarUrl alt=user.id}} class="avatar img-circle">
            {{user.name}}
          {{/link-to}}
        </div>
      {{/each}}
    </div>
  </script>

  <script type="text/x-handlebars" data-template-name="user">
    <h1>
      <img {{bind-attr src=model.avatarUrl alt=model.id}} class="avatar img-circle">
      {{model.name}}
    </h1>
    {{matches-table matches=controller.matches user=model}}
  </script>


  <script src="js/jquery.js"></script>
  <script src="js/firebase.js"></script>
  <script src="js/handlebars.js"></script>
  <script src="js/ember.js"></script>
  <script src="js/ember-data.js"></script>
  <script src="js/emberfire.js"></script>
  <script src="js/firebase-simple-login.js"></script>
  <script src="js/moment-with-langs.js"></script>
  <script src="js/bootstrap.js"></script>
  <script src="js/app.js"></script>

  <script>
   $(function() {
   });
  </script>

</body>
</html>
